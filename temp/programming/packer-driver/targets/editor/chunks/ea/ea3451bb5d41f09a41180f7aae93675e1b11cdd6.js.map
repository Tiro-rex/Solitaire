{"version":3,"sources":["file:///D:/GAMIXLABS/Solitaire/assets/Script/Pile.ts"],"names":["_decorator","Component","Collider2D","PhysicsSystem2D","Contact2DType","cardMove","snapParent","ReaveldCard","ccclass","property","Pile","offCard","cardR","start","instance","enable","coll","node","getComponent","on","BEGIN_CONTACT","onBeginContact","onDisable","off","init","array","len","count","i","delay","addChild","children","faceDown","active","self","other","indexforstack","length","emit","sp","c","tag","window","moveCard","snapCardToParent","console","log","card","removeChild","value","index","cardInStack","toString","removeListener","milliseconds","Promise","resolve","setTimeout"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Prefab, instantiate, EventMouse, Touch, Vec2, Vec3, Button, Collider2D, PhysicsSystem2D, Contact2DType, game } from 'cc';\nimport { Card } from './Card';\nimport { cardMove, CARDS_ARRAY, Ranks, snapParent } from './GameConstant';\nimport { GameScreen } from './GameScreen';\nimport ReaveldCard from './ReaveldCard';\nconst { ccclass, property } = _decorator;\n\n\n@ccclass('Pile')\nexport class Pile extends Component {\n    // @property(Node)\n    // deckOfCard: Node;\n\n    offCard: any[];\n\n    public cardR: any;\n    snapParent: any;\n    // snapcard: boolean = false;\n\n    start() {\n        PhysicsSystem2D.instance.enable = true;\n        let coll = this.node.getComponent(Collider2D);\n        coll.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\n        // this.cardR.getComponent(ReaveldCard)\n    }\n    onDisable() {\n        this.node.off(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\n    }\n    async init(array, len, count) {\n        // console.log(array, len, count);\n        // if (len == 1) {\n        //     console.log(\"ifloop\")\n        //     this.node.addChild(array[count - 1]);\n        // }\n        // else {\n        for (let i = 0; i < len; i++) {\n            await this.delay(200, this.node.addChild(array[count + i]));\n\n        }\n        // }\n        this.node.children[len - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n    }\n    onBeginContact(self: Collider2D, other: Collider2D) {\n        this.snapParent = self.node;\n        this.cardR = other.node;\n        // console.log(\"hhihihi\", self);\n        let indexforstack = this.snapParent.children.length\n        snapParent.emit(\"ParentforSnap\", { sp: this.snapParent, c: this.cardR })\n\n\n\n        // console.log(\"Snaping Parent\", this.snapParent);\n\n        if (self.tag == 1 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n        if (self.tag == 2 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n        if (self.tag == 3 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n        if (self.tag == 4 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n        if (self.tag == 5 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n        if (self.tag == 6 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n        if (self.tag == 7 && window.moveCard) {\n            this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n\n            cardMove.on(\"snapCard\", this.snapCardToParent, this)\n            console.log(\"stack-->\", self.tag);\n        }\n    }\n    // checkBeforesnap() {\n\n    //     console.log(\"card\", value)\n    // }\n    // checkindex()\n    // {\n    //     let index = this.node.children.length;\n    //     if(index==0){\n    //         this.snapParent.addChildc\n    //     }\n    // }\n    snapCardToParent(card) {\n\n        this.node.removeChild(card);\n        let value = this.cardR.getComponent(ReaveldCard).value\n        let index = this.node.children.length;\n        let indexforstack = this.snapParent.children.length\n        let cardInStack = this.snapParent.children[index - 1].getComponent(ReaveldCard).value\n        if (index == 0) {\n            this.snapParent.addChild(card);\n        }\n        console.log(\"card  \", value.toString())\n        console.log(\"cardStack  \", cardInStack.toString())\n        if (value + 1 == cardInStack) {\n            this.snapParent.addChild(card);\n\n        } else {\n            console.log(\"elsePart\");\n\n        }\n        this.snapParent.children[indexforstack - 1].getComponent(ReaveldCard).faceDown.active = false;\n        cardMove.removeListener(\"snapCard\", this.snapCardToParent, this)\n    }\n\n\n    delay(milliseconds: number, count): Promise<number> {\n        return new Promise<number>(resolve => {\n            setTimeout(() => {\n                resolve(count);\n            }, milliseconds);\n        });\n    }\n}"]}